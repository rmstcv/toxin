"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[296],{72:function(e,t,n){var i=n(791),o=n(135),a=n.n(o);n(106);var r=function(e){document.querySelector(".room-details-images").innerHTML='\n  <div class="room-details-images__main">\n    <img src='.concat(e[3],' alt="image" loading="lazy" width="979" height="485">\n  </div>\n  <div class="room-details-images__second">\n    <img src=').concat(e[1],' alt="image" loading="lazy" width="459" height="240">\n  </div>\n  <div class="room-details-images__third">\n    <img src=').concat(e[0],' alt="image" loading="lazy" width="459" height="240">\n  </div>\n  ')},c=n(444);var s=function(e){for(var t=Object.entries(e),n=0;n<t.length;n+=1){var i=(0,c.Z)(t[n],2),o=i[0],a=i[1];document.querySelector(".details__text_".concat(o)).innerHTML=a}},l=n(951),u=n(976),d=(n(833),n(186),n(507)),v=n(657),m=n(772),f=function(){function e(t,n){(0,l.Z)(this,e),this.form=document.querySelector(".booking-form"),this.room=n,this.roomData=t}return(0,u.Z)(e,[{key:"insertCalcInfo",value:function(){var e,t,n=document.createElement("div"),i=Number(this.roomData.price);try{e=new Date(localStorage.getItem("dateIn")),t=new Date(localStorage.getItem("dateOut"))}catch(n){e=0,t=0}var o=(t.getTime()-e.getTime())/864e5,a="суток",r=0,c=2179,s=300;this.roomData.price&&0!==o||(r=0,c=0,s=0);var l=(0,v.Z)(r+s-c+i*o);1===o&&(a="сутки");var u='\n      <div class = "booking-form__value-calc booking-form__value-calc_days-calc">\n        <div>'.concat((0,v.Z)(i),"&#8381; x ").concat(o," ").concat(a,'</div>\n        <div class = "booking-form__value-sum">').concat((0,v.Z)(i*o),'&#8381;</div>\n      </div>\n      <div class = "booking-form__value-calc">\n        <div>Сбор за услуги: скидка ').concat((0,v.Z)(c),'&#8381;</div>\n        <div class = "booking-form__info"></div>\n        <div class = "booking-form__value-sum">').concat(r,'&#8381;</div>\n        <div>Сбор за дополнительные услуги</div>\n        <div class = "booking-form__info"></div>\n        <div class = "booking-form__value-sum">').concat(s,'&#8381;</div>\n      </div>\n    <div class = "booking-form__calc-total">\n      <div>Итого</div>\n      <div class = "booking-form__calc-line"></div>\n      <div>').concat(l,"&#8381;</div>\n    </div>\n    ");n.classList.add("booking-form__calc-content"),n.innerHTML=u,document.querySelector(".booking-form__calc").appendChild(n)}},{key:"init",value:function(){(0,d.Z)(this.roomData,this.form.firstElementChild),this.insertCalcInfo()}}]),e}();(0,i.Z)(a().mark((function e(){var t,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n=localStorage.getItem("room"),t=n}catch(e){t="888"}return e.next=3,(0,m.Z)("data.json",t);case 3:i=e.sent,new f(i,t).init();case 6:case"end":return e.stop()}}),e)})))();var h=function(e){for(var t=document.querySelector(".js-chart svg"),n=116*Math.PI,i=0,o=0;o<e.length;o+=1)i+=e[o];for(var a=[{name:"bad",color1:"#8BA4F9",color2:"#3D4975"},{name:"satisfactory",color1:"#BC9CFF",color2:"#8BA4F9"},{name:"good",color1:"#6FCF97",color2:"#66D2EA"},{name:"excellent",color1:"#FFE39C",color2:"#FFBA9C"}],r=[],c=n/100*25,s=0;s<a.length;s+=1)if(e[s]>0){var l=n/100*(e[s]/i*100),u='\n        <defs>\n          <linearGradient id="'.concat(a[s].name,'" x1="0%" y1="0%" x2="0%" y2="100%">\n            <stop offset="0%" stop-color="').concat(a[s].color1,'" />\n            <stop offset="100%" stop-color="').concat(a[s].color2,'" />\n          </linearGradient>\n        </defs>\n        <circle class="').concat(a[s].name,'" \n          stroke-dasharray="').concat(l-2," ").concat(n-l+2,'" \n          stroke-dashoffset="').concat(c-2,'"\n          cx=').concat(60," cy=").concat(60," r=").concat(58,'\n          stroke="url(#').concat(a[s].name,')">\n        </circle>\n      ');c-=l,r.push(u)}var d,v=r.join("");t.innerHTML="\n    ".concat(v,"\n  "),d=i,document.querySelector(".js-chart__number").innerHTML=d};function k(){return(k=(0,i.Z)(a().mark((function e(t,n){var i,o,r,c,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[{room:888,reviews:{id:"",name:"",text:"",date:"",likes:"",avatar:""}}],e.prev=1,e.next=4,fetch(t);case 4:return r=e.sent,e.next=7,r.json();case 7:c=e.sent,s=0;case 9:if(!(s<c.length)){e.next=16;break}if(c[s].room!==n){e.next=13;break}return o=c[s],e.abrupt("break",16);case 13:s+=1,e.next=9;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),o=i;case 21:return e.abrupt("return",o);case 22:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}var _=function(e,t){return k.apply(this,arguments)};var g=function(){function e(t,n){var i,o,a,r=this;(0,l.Z)(this,e),a=function(){var e=r.findElems(".like-button__number-of-likes");0===r.getIsLike()&&(e.innerHTML=r.likes+1,r.likes=r.likeButton.setAttribute("data-likes",r.likes+1),r.likeButton.setAttribute("data-isLiked","1")),r.checkLikes(),r.likeButton.removeEventListener("click",r.addLike)},(o="addLike")in(i=this)?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,this.likeButton=t,this.likes=n,this.test=1}return(0,u.Z)(e,[{key:"setLikes",value:function(){this.likeButton.setAttribute("data-isLiked",this.likes)}},{key:"getIsLike",value:function(){return+this.likeButton.getAttribute("data-isLiked")}},{key:"findElems",value:function(e){for(var t=document.querySelectorAll(e),n=[],i=0;i<t.length;i+=1)t[i].closest(".js-like-button")===this.likeButton&&n.push(t[i]);return 1!==n.length?n:n[0]}},{key:"checkLikes",value:function(){var e=this.findElems(".js-like-button__heart_colored"),t=this.findElems(".js-like-button__heart_uncolored");1===this.getIsLike()?e.classList.add("like-button__heart_active"):t.classList.add("like-button__heart_active")}},{key:"addLikes",value:function(){this.findElems(".js-like-button__number-of-likes").innerHTML=this.likes}},{key:"addLikeButtonHandler",value:function(){this.test=2,this.likeButton.addEventListener("click",this.addLike)}},{key:"likeButtonInit",value:function(){this.checkLikes(),this.addLikes(),this.addLikeButtonHandler()}}]),e}();var b=function(e,t){var n;document.querySelectorAll(".js-like-button").forEach((function(e){e.parentElement===t&&(n=e)})),(n=new g(n,e)).likeButtonInit()};function y(e){var t,n;return 1==+e&&(t="1 день назад"),+e>1&&+e<5&&(t="".concat(e," дня назад")),+e>=5&&+e<7&&(t="".concat(e," дней назад")),+e>=7&&+e<14&&(t="неделю назад"),+e>=14&&+e<30&&(n=Math.round(e/7),t="".concat(n," недели назад")),+e>=30&&+e<60&&(t="месяц назад"),+e>=60&&+e<120&&(n=Math.round(e/30),t="".concat(n," месяца назад")),+e>=120&&+e<365&&(n=Math.round(e/30),t="".concat(n," месяцев назад")),+e>=365&&+e<730&&(n=Math.round(e/365),t="год назад"),+e>=720&&+e<1460&&(n=Math.round(e/365),t="".concat(n," года назад")),+e>=1460&&(n=Math.round(e/365),t="".concat(n," лет назад")),t}var p=function(e){for(var t=document.querySelectorAll(".js-review"),n=document.querySelectorAll(".js-review__name"),i=document.querySelectorAll(".js-review__image"),o=document.querySelectorAll(".js-review__text"),a=document.querySelectorAll(".js-review__likes"),r=document.querySelectorAll(".js-review__date"),c=new Date,s=0;s<t.length;s+=1){n[s].innerHTML=e[s].name,i[s].setAttribute("src","".concat(e[s].avatar)),o[s].innerHTML=e[s].text;var l=new Date(e[s].date),u=Math.round((c-l)/864e5);r[s].innerHTML=y(u),b(e[s].likes,a[s])}};var L=function(e){for(var t=document.querySelector(".js-rules-list"),n=[{id:1,text:"Нельзя с питомцами"},{id:2,text:"Без вечеринок и мероприятий"},{id:3,text:"Время прибытия — после 13:00, а выезд до 12:00"}],i=document.createElement("ul"),o=function(t){e[t]&&n.forEach((function(n){if(n.id===e[t]){var o=document.createElement("li");o.innerHTML="\n            <div>".concat(n.text,"</div>\n          "),i.appendChild(o)}}))},a=0;a<3;a+=1)o(a);t.appendChild(i)};function w(){return(w=(0,i.Z)(a().mark((function e(){var t,n,i,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t=localStorage.getItem("room")}catch(e){t="888"}return e.next=3,(0,m.Z)("data.json",t);case 3:return n=e.sent,r(n.images),s(n.details),h(n.votes),e.next=9,_("reviews.json",t);case 9:i=e.sent,p(i.reviews),0===(o=document.querySelectorAll(".js-review").length)&&(c="0 отзывов"),1===o&&(c="1 отзыв"),o>1&&o<=4&&(c="".concat(o," отзыва")),o>4&&(c="".concat(o," отзывов")),document.querySelector(".js-room-details__reviews-title-counter").innerHTML=c,L(n.rules);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){w.apply(this,arguments)}()}},function(e){e.O(0,[374,436,890],(function(){return t=72,e(e.s=t);var t}));e.O()}]);